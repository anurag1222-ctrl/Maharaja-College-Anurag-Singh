<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Publish Notice - Maharaja College</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div class="dashboard">
        <nav class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <h2>ğŸ‘¨â€ğŸ« Teacher Portal</h2>
                <button class="close-btn" id="closeSidebar">Ã—</button>
            </div>
            <ul class="nav-menu">
                <li><a href="teacherDashboard.html">ğŸ“Š Dashboard</a></li>
                <li><a href="materials.html">ğŸ“š Materials</a></li>
                <li><a href="tests.html">ğŸ“ Tests</a></li>
                <li><a href="performance.html">ğŸ“ˆ Performance</a></li>
                <li><a href="notice-upload.html" class="active">ğŸ“¢ Publish Notice</a></li>
                <li><a href="notices.html">ğŸ“‹ Notices</a></li>
                <li><a href="chat.html">ğŸ’¬ Group Chat</a></li>
                <li><a href="#" id="logoutBtn">ğŸšª Logout</a></li>
            </ul>
        </nav>
        <main class="main-content">
            <header class="top-bar">
                <button class="menu-btn" id="menuBtn">â˜°</button>
                <h1>ğŸ“¢ Publish New Notice</h1>
                <div class="user-info">
                    <span id="userName">Teacher</span>
                </div>
            </header>
            <div class="content">
                <div class="section">
                    <form id="publishForm" class="form">
                        <div class="form-group">
                            <label>ğŸ“Œ Title</label>
                            <input type="text" id="noticeTitle" required placeholder="Enter notice title">
                        </div>
                        
                        <div class="form-group">
                            <label>ğŸ“„ Description</label>
                            <textarea id="noticeDesc" required placeholder="Enter notice details..." rows="6"></textarea>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label>ğŸ·ï¸ Category</label>
                                <select id="noticeCategory" required>
                                    <option value="general">ğŸ“¢ General</option>
                                    <option value="academic">ğŸ“ Academic</option>
                                    <option value="exam">ğŸ“ Exam</option>
                                    <option value="holiday">ğŸ‰ Holiday</option>
                                    <option value="urgent">ğŸš¨ Urgent</option>
                                    <option value="event">ğŸ“… Event</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>ğŸ¯ Priority</label>
                                <select id="noticePriority" required>
                                    <option value="low">ğŸŸ¢ Low</option>
                                    <option value="medium">ğŸŸ¡ Medium</option>
                                    <option value="high">ğŸ”´ High</option>
                                </select>
                            </div>
                        </div>

                        <div class="form-group">
                            <label>ğŸ“… Valid Until (Optional)</label>
                            <input type="date" id="noticeExpiry">
                        </div>

                        <div class="quick-notice-templates">
                            <h4>ğŸš€ Quick Notice Templates:</h4>
                            <div class="template-buttons">
                                <button type="button" class="btn btn-small btn-secondary" onclick="fillNoticeTemplate('holiday')">ğŸ‰ Holiday</button>
                                <button type="button" class="btn btn-small btn-secondary" onclick="fillNoticeTemplate('exam')">ğŸ“ Exam</button>
                                <button type="button" class="btn btn-small btn-secondary" onclick="fillNoticeTemplate('meeting')">ğŸ‘¥ Meeting</button>
                                <button type="button" class="btn btn-small btn-secondary" onclick="fillNoticeTemplate('urgent')">ğŸš¨ Urgent</button>
                                <button type="button" class="btn btn-small btn-secondary" onclick="fillNoticeTemplate('general')">ğŸ“¢ General</button>
                            </div>
                        </div>
                        
                        <div class="form-actions">
                            <button type="submit" class="btn btn-primary">âœ… Publish Notice</button>
                            <button type="button" class="btn btn-secondary" onclick="clearNoticeForm()">ğŸ”„ Clear Form</button>
                            <button type="button" class="btn btn-outline" onclick="saveAsDraft()">ğŸ’¾ Save as Draft</button>
                        </div>
                    </form>
                </div>
            </div>
        </main>
    </div>

    <script src="js/dataHandler.js"></script>
    <script>
        const user = DataHandler.getCurrentUser();
        if (!user || (user.type !== 'teacher' && user.type !== 'admin')) {
            window.location.href = 'index.html';
        }

        document.getElementById('userName').textContent = user.name;

        // Quick notice templates
        function fillNoticeTemplate(type) {
            const templates = {
                'holiday': {
                    title: 'Holiday Announcement - ',
                    desc: 'School will remain closed on [date] due to [reason]. All classes will resume normally on [date]. Please plan accordingly.',
                    category: 'holiday',
                    priority: 'medium'
                },
                'exam': {
                    title: 'Exam Schedule - ',
                    desc: 'Important: The [exam name] will be conducted on [date]. Please bring your admit card and necessary stationery. Hall tickets available at [location].',
                    category: 'exam',
                    priority: 'high'
                },
                'meeting': {
                    title: 'Parent-Teacher Meeting - ',
                    desc: 'We cordially invite you for the parent-teacher meeting on [date] at [time] in [location]. Please make it convenient to attend.',
                    category: 'event',
                    priority: 'medium'
                },
                'urgent': {
                    title: 'URGENT: ',
                    desc: 'ATTENTION: [Important information]. This requires immediate action. Please comply by [deadline].',
                    category: 'urgent',
                    priority: 'high'
                },
                'general': {
                    title: 'General Notice - ',
                    desc: 'This is to inform all students that [information]. Please take note and follow the guidelines provided.',
                    category: 'general',
                    priority: 'low'
                }
            };
            
            const template = templates[type];
            document.getElementById('noticeTitle').value = template.title;
            document.getElementById('noticeDesc').value = template.desc;
            document.getElementById('noticeCategory').value = template.category;
            document.getElementById('noticePriority').value = template.priority;
            document.getElementById('noticeTitle').focus();
        }
        
        function clearNoticeForm() {
            document.getElementById('publishForm').reset();
        }

        function saveAsDraft() {
            const notice = {
                id: Date.now().toString(),
                title: document.getElementById('noticeTitle').value,
                description: document.getElementById('noticeDesc').value,
                category: document.getElementById('noticeCategory').value,
                priority: document.getElementById('noticePriority').value,
                expiryDate: document.getElementById('noticeExpiry').value,
                publishedBy: user.id,
                publishDate: new Date().toISOString(),
                semester: '3',
                course: 'BCA',
                status: 'draft'
            };
            
            DataHandler.addNotice(notice);
            alert('âœ… Notice saved as draft!');
        }
        
        document.getElementById('publishForm').addEventListener('submit', (e) => {
            e.preventDefault();
            const notice = {
                id: Date.now().toString(),
                title: document.getElementById('noticeTitle').value,
                description: document.getElementById('noticeDesc').value,
                category: document.getElementById('noticeCategory').value,
                priority: document.getElementById('noticePriority').value,
                expiryDate: document.getElementById('noticeExpiry').value,
                publishedBy: user.id,
                publishDate: new Date().toISOString(),
                semester: '3',
                course: 'BCA',
                status: 'published'
            };
            
            DataHandler.addNotice(notice);
            alert('âœ… Notice published successfully!');
            window.location.href = 'notices.html';
        });

        // Event Listeners
        document.getElementById('menuBtn').addEventListener('click', () => {
            document.getElementById('sidebar').classList.add('active');
        });

        document.getElementById('closeSidebar').addEventListener('click', () => {
            document.getElementById('sidebar').classList.remove('active');
        });

        document.getElementById('logoutBtn').addEventListener('click', (e) => {
            e.preventDefault();
            DataHandler.logout();
            window.location.href = 'index.html';
        });
    </script>
</body>
</html>